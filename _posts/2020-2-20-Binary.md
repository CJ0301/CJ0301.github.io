---
layout: 		post
title: 			"位运算"
subtitle: 		'二进制基础以及算法应用'
author: 		"CJ"
header-img: 	"img/post-bg-ele.jpg"
outer-img:		"post-bg-ele.jpg"
header-mask: 	0.3
catalog: 		true
tags:
  - Electronic Science
  - Computer Science
---

> 二进制是指在数学和数学电路中以2为基数的计数系统

## 原码、反码和补码

#### 原码表示法

&emsp;原码:又称为符号数值表示法，是一种比较直观的编码表示法 
 
&emsp;符号位:表示了数据的正负

- 数码0表示正，数码1表示负
- 数值部分保留真值特性，为真值绝对值
- 符号位+真值绝对值
- 正数的原码是其

#### 反码

- 符号位与原码相同
- 数值位和符号位有关

正数的反码为整数本身，与原码形式相同。  
负数的反码符号位为1，数值部分由原码的数值部分按位取反得到。

🌰：  
X = +0.1011，则[X]反 = 0.1011  
X = -0.1011 则[X]反 = 1.0100  
X = -13/16的二进制反码为：  
[X]反= [-0.1101]反 = 1.0010（先算分子再小数点后移）

#### 补码

- 符号位与原码相同
- 数值位和符号位有关
 
正数的补码就是其本身。  
负数的补码是在其原码的基础上, 符号位不变, 其余各位取反, 最后+1. (即在反码的基础上+1)。

🌰：  
[+1] = [00000001]原 = [00000001]反 = [00000001]补  
[-1] = [10000001]原 = [11111110]反 = [11111111]补

## 位运算符
基本的位运算有与、或、异或、取反、左移、右移六种

&:当两数相同位都是1才是1，否则为0。
```
    0110
&   0100
-----------
    0100
```

|:当两数相同位有一个是1就是1，都为0则是0。
```
    0110
&   0100
-----------
    0110
```

^:当两数相同位一样则为0，不同则为1
```
    0110
&   0100
-----------
    0010
```

~:每一个位置0变1，1变0
```
~   0110
-----------
    1001
```

\<<:向左进行位移操作，高位丢弃，低位补0(每移一位相当于乘2)  
```
8<<1 = 16
```

\>>:向右进行位移操作，高位补0，低位丢弃(每移一位相当于除2)  
```
8>>1 = 4
7>>1 = 3
```

## 位运算的使用技巧
1.判断奇偶数
思路：用与判断第一位是否是1
```java
if((num & 1)==0) {
	//偶数
}else {
	//奇数
}
```

2.判断第n位是否为1
```java
public static boolean isOne(int x,int n) {
	if ((x>>--n&1)==0) {
		return false;
	}else {
		return true;
	}
}
```

3.将第n位设置成1
```
x = x|1<<(--n);
```

4.将第n位设置成0
```java
x = x&~(1<<(--n));
```

5.第n位取反
```
x = x^(1<<(--n));
```

6.将最右边的1设置为0
```
x = x & (x-1);
```

## 例题
例1🌰.有 8 个一模一样的瓶子，其中有 7 瓶是普通的水，有一瓶是毒药。任何喝下毒药的生物都会在一星期之后死亡。现在，你只有 3 只小白鼠和一星期的时间，如何检验出哪个瓶子里有毒药？

思路：将八瓶药进行编号，分别为001，010，011，100，101，110，111，三只老鼠分别喝下混有第一位有一的药，第二位有一的药，第三位有一的药，最后根据老鼠的死亡判断每一位的数字即可。

例2🌰.给定一个非负整数 num. 对于 0 ≤ i ≤ num 范围中的每个数字 i, 计算其二进制数中 1 的数目并将它们作为数组返回。输入: 5 输出: [0,1,1,2,1,2] (leetcode232)
```java
public static int[] countBits(int num) {
	int[] bits = new int[num+1];
	Arrays.fill(bits, 0);

	for (int i = 1; i <= num; i++) {
		bits[i] = bits[i & (i-1)] + 1;
	}
	return bits;
}
```

例3🌰.不用乘除、for、while、if、else、switch、case等关键字及条件判断语句算1+2+3+..+n。
```java
public static int sum(int i) {
	return (int)(i+Math.pow(i, 2))>>1;
}
```

例4🌰.八皇后
```java
public class Test {
	static int count=0;
	public static void main(String[] args) {
		queenSettle(0, 0, 0, 0);
		System.out.println(count);
	}
	
	public static void queenSettle(int row,int colomn,int pie,int na) {
		int N = 8; // 8皇后
		if (row >= N) {
		    // 遍历到最后一行说明已经找到符合的条件了
		    count++;
		}

	    // 取出当前行可放置皇后的格子
		int bits = (~(colomn|pie|na)) & ((1 << N)-1);

		while(bits > 0) {
	            // 每次从当前行可用的格子中取出最右边位为 1 的格子放置皇后
	            int p = bits & -bits;

	            // 紧接着在下一行继续放皇后
	            queenSettle(row+1, colomn | p, (pie|p) << 1, (na | p) >> 1);

	            // 当前行最右边格子已经选完了，将其置成 0，代表这个格子已遍历过
	            bits = bits & (bits-1);
		}
	}
	
}
```